{"version":3,"sources":["App.js","index.js"],"names":["App","state","name","message","winner","userMode","gameField","ameSet","leaderBoard","button","timer","this","getGameSettings","getLeaderBord","fetch","then","res","json","data","_this2","setState","gameSet","_this3","newName","mode","field","i","push","setRandomMove","fieldlength","_this4","_loop","randomKey","Math","floor","random","prewState","Object","toConsumableArray","Date","newGame","event","clickKey","target","dataset","set","time","checkWinner","delay","countGreen","countRed","length","asyncToGenerator","regenerator_default","a","mark","_callee3","rawResponse","content","wrap","_context3","prev","next","method","headers","Accept","Content-Type","body","JSON","stringify","date","toString","sent","console","log","stop","_this5","dataArrKey","key","react_default","createElement","className","onChange","setGameMode","value","map","item","type","setName","placeholder","onClick","onButtonClick","onMakeMove","Fragment","data-set","id","React","Component","ReactDOM","render","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.7a8c3104.chunk.js","sourcesContent":["import React from 'react';\nimport './App.css';\n\nclass App extends React.Component {\n  state = {\n    name:'',\n    message: '',\n    winner: null,\n    userMode:{},\n    gameField:[], ameSet:{},\n    leaderBoard:[],\n    button:'Play',\n    timer: null\n  };\n\n  componentDidMount() {\n    this.getGameSettings();\n    this.getLeaderBord();\n  }\n\n  async getGameSettings() {\n     await fetch('https://starnavi-frontend-test-task.herokuapp.com/game-settings')\n        .then(res => res.json())\n        .then(data => {\n          this.setState({\n            gameSet: data\n          })\n        });\n  }\n\n  async getLeaderBord(){\n    await fetch('https://starnavi-frontend-test-task.herokuapp.com/winners')\n        .then(res => res.json())\n        .then(data => {\n          this.setState({leaderBoard: data})\n        });\n  }\n\n  setName(newName){\n    this.setState({\n      name: newName\n    });\n  }\n\n setGameMode(mode) {\n    const field = this.state.gameSet[mode].field;\n    let gameField = [];\n    for (let i = 0; i < field*field; i++) {\n      gameField.push('');\n    }\n    this.setState( {\n      userMode: this.state.gameSet[mode],\n      gameField\n    });\n  }\n\n  newGame() {\n    const field = this.state.userMode.field;\n    let gameField = [];\n    for (let i = 0; i < field*field; i++) {\n      gameField.push('');\n    }\n    this.setState( {\n      gameField\n    });\n    this.setRandomMove(this.state.userMode.field * this.state.userMode.field);\n\n  }\n\n  setRandomMove(fieldlength) {\n    for (let i = 0; i<(fieldlength); i++ ) {\n      const randomKey = Math.floor(Math.random() * fieldlength);\n      if (this.state.gameField[randomKey] === '') {\n        this.setState((prewState) => {\n          const gameField = [...prewState.gameField];\n          gameField[randomKey] = 'blue';\n          return {\n            gameField,\n            timer: new Date(),\n            message: prewState.name\n          }\n        });\n        break;\n      }\n    }\n  }\n\n  onButtonClick() {\n    this.setState({\n      button: 'Play Again',\n      message: 'Hello '+this.state.name,\n    });\n    this.newGame();\n  };\n\n  onMakeMove(event) {\n    const clickKey = event.target.dataset.set;\n    const time = new Date();\n    this.checkWinner();\n\n    if ( this.state.winner !== null) {return;}\n\n    if (this.state.gameField[clickKey] !== 'blue') {return;}\n\n    if (time - this.state.timer < this.state.userMode.delay ) {\n      if (this.state.gameField[clickKey] === 'blue') {\n        this.setState((prewState) => {\n          const gameField = [...prewState.gameField];\n          gameField[clickKey] = 'green';\n          return {\n            gameField,\n            timer: null\n          }\n        });\n          this.setRandomMove(this.state.userMode.field * this.state.userMode.field);\n      }\n    }\n    else if (this.state.gameField[clickKey] === 'blue') {\n      this.setState((prewState) => {\n        const gameField = [...prewState.gameField];\n        gameField[clickKey] = 'red';\n        return {\n          gameField,\n          timer: null\n        }\n      });\n        this.setRandomMove(this.state.userMode.field * this.state.userMode.field);\n    }\n\n  }\n\n  checkWinner () {\n    let countGreen = 0;\n    let countRed = 0;\n    for (let i = 0; i < this.state.gameField.length; i++) {\n      if (this.state.gameField[i] !== '') {\n        if (this.state.gameField[i] === 'green') {countGreen++}\n        if (this.state.gameField[i] === 'red') {countRed++}\n      }\n    }\n\n    if (countRed + countGreen > this.state.gameField.length / 2) {\n      const winner =  (countGreen > countRed) ? this.state.name : 'Computer';\n        (async () => {\n            const rawResponse = await fetch('https://starnavi-frontend-test-task.herokuapp.com/winners', {\n                method: 'POST',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({winner: winner, date:(new Date()).toString()})\n            });\n            const content = await rawResponse.json();\n            console.log(content);\n        })();\n      this.setState( {\n          winner: winner\n      })\n    }\n  }\n\n  render(){\n    let dataArrKey = [];\n    for (let key in this.state.gameSet) {\n      dataArrKey.push(key);\n    }\n    const field = this.state.userMode.field;\n    let message = (this.state.message === '')\n        ? 'Message here'\n        : 'Hello ' + this.state.message;\n    if (this.state.winner !== null) {\n      message = 'Winner ' + this.state.winner;\n    }\n\n    return (\n        <div className=\"App\">\n          <div>\n              <div className=\"prepare-game\">\n                  <select\n                      name=\"game-set\"\n                      onChange={(event) => this.setGameMode(event.target.value)}\n                  >\n                      <option value=\"start\">Pick game mode</option>\n                      {dataArrKey.map( item =>\n                          <option\n                              value={item}\n                              key={item}\n                          > {item} </option>\n                      )}\n                  </select>\n                  <input type=\"text\"\n                         value={this.state.name}\n                         onChange={(event) => this.setName(event.target.value)}\n                         placeholder=\"Enter your name\"/>\n                  <button onClick={ () => this.onButtonClick() }>\n                      {this.state.button}\n                  </button>\n              </div>\n              <div className=\"game-field\" >\n                  <p className=\"game-info\">{message}</p>\n                  <div onClick={(event) => this.onMakeMove(event)}>\n                      {this.state.gameField.map((item,key) => {\n                          return(\n                              <React.Fragment key={key*200} >\n                      <span\n                          key={key}\n                          className={item}\n                          data-set={key}>\n                      </span>\n                                  {((key+1) % field === 0) ? <br key={key*200}/> : ''}\n                              </React.Fragment>\n                          )})}\n                  </div>\n              </div>\n          </div>\n          <div>\n              <h2>Leader Bord</h2>\n            <div className=\"leader-item\">\n                {this.state.leaderBoard.map(item  => {\n                   return <div\n                        key={item.id}\n                   > <span>{item.winner}</span> <span>{item.date}</span> </div>\n                })}\n            </div>\n          </div>\n        </div>\n    );\n  }\n\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n\n"],"sourceRoot":""}